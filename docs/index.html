<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width" charset="utf-8">
    <title>Grow.js</title>
    <link rel="stylesheet" href="http://getbootstrap.com/2.3.2/assets/css/bootstrap.css">
    <link rel="stylesheet" href="http://getbootstrap.com/2.3.2/assets/css/bootstrap-responsive.css">
    <link rel="stylesheet" href="http://getbootstrap.com/2.3.2/assets/css/docs.css">
    <style>
      body > .navbar .brand {
        float:left;
        text-shadow: rgba(255, 255, 255, 0.0980392) 0px 1px 0px, rgba(255, 255, 255, 0.4) 0px 0px 30px;
        color: white;
        margin-left:0px;
        font-weight:normal;
      }
      
      .bs-docs-sidenav.affix {
        box-shadow: 0 0 20px 1px rgba(0, 0, 0, 0.5);
        z-index: 10;
      }
      
      .bs-docs-sidenav i{
        width: 8px;
        height: 8px;
        padding: 0px;
        margin: 0px;
        display: inline-block;
        margin-right:0.5em;
      }
      
      .bs-docs-sidenav > li > a {
          word-wrap: break-word;
      }
      
      .bs-docs-sidenav > li:first-child > a {
        border-top-right-radius: 6px;
        border-top-left-radius: 6px;
      }
      
      code[class*="language-"],pre[class*="language-"]{color:black;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*="language-"],pre[class*="language-"]{background:#f5f2f0}:not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray}.token.punctuation{color:#999}.namespace{opacity:.7}.token.property,.token.tag,.token.boolean,.token.number{color:#905}.token.selector,.token.attr-name,.token.string{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.regex,.token.important{color:#e90}.token.important{font-weight:bold}.token.entity{cursor:help}
      div.description {margin: 14px 0; padding-top: 14px; border-bottom:1px solid #eee; }
      .tags {}
      .ctx-type {
        display:inline-block;
        margin-right:0.5em;
        //- float:right; margin-top:8px
      }
      
      footer iframe{vertical-align:middle;}
      
    </style>
  </head>
  <body data-spy="scroll" data-target=".scrollspy">
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container"><a href="http://commongarden.org" class="brand">Common Garden</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right sponsored"></ul>
          </div>
        </div>
      </div>
    </div>
    <header id="overview" class="jumbotron subhead">
      <div class="container">
        <h1>Grow.js</h1>
        <p class="lead"></p>
      </div>
    </header>
    <div class="container">
      <div class="row">
        <div class="span3 bs-docs-sidebar">
          <ul class="nav nav-list bs-docs-sidenav affix-top">
            <li class="active"><a href="/docs/index.html">Main</a></li>
            <li><a href="/docs/grow.js.html">grow.js</a></li>
          </ul>
          <div class="scrollspy">
            <ul class="nav nav-list bs-docs-sidenav affix-top">
            </ul>
          </div>
        </div>
        <div class="span9">
          <section id="Main"><h1>Getting started</h1>
<p>Grow.js is an npm packagle for creating and connecting devices to a <a href="https://github.com/CommonGarden/Grow-IoT">Grow-IoT</a> instance. It is loosely based off of some of the work happening on the W3C web-of-things community group. <a href="http://commongarden.github.io/grow.js/">Full grow.js documentation can be found here</a>.</p><p>You will need a microcontroller (such as arduino or raspberry pi). Grow.js works with most devices that can run node, and plays very well with the <a href="http://johnny-five.io/">Johnny-Five robotics library</a>, which has plugins for <a href="http://johnny-five.io/#platform-support">a large number of devices</a>.</p><p>Install with:</p><pre><code class="lang-bash">npm install grow.js
</code></pre>
<p>You can connect to our Grow-IoT alpha instance on <a href="https://grow.commongarden.org">https://grow.commongarden.org</a>, or see the <a href="https://github.com/CommonGarden/Grow-IoT">Grow-IoT repo</a> to easily start your own IoT network locally or hosted on <a href="https://galaxy.meteor.com">Meteor Galaxy</a>.</p><h1>Example</h1>
<p>Using grow.js is as simple as passing in a configuration object to the constructor.</p><p>Create a file called <code>example.js</code>. And insert the following:</p><pre><code class="lang-javascript">// Import the grow.js library.
var GrowInstance = require(&#39;grow.js&#39;);

// Create a new grow instance.
var grow = new GrowInstance({
    &quot;host&quot;: &quot;grow.commongarden.org&quot;, // Where the device will be connecting to.
    // The following are connection options for connecting to a meteor galaxy instance.
    &quot;tlsOpts&quot;: {
        &quot;tls&quot;: {
            &quot;servername&quot;: &quot;galaxy.meteor.com&quot;
        }
    },
    &quot;port&quot;: 443, // The port to connect to 
    &quot;ssl&quot;: true, // Set to true when connecting over SSL.
    &quot;name&quot;: &quot;Light&quot;, // The display name for the thing.
    &quot;desription&quot;: &quot;An LED light with a basic on/off api.&quot;,
    &quot;state&quot;: &quot;off&quot;, // The current state of the thing.
    &quot;owner&quot;: &quot;youremailhere@example.com&quot;, // The email of the account you want this device to be added to.
    &quot;actions&quot;: [ // A list of action objects
        {
            &quot;name&quot;: &quot;On&quot;, // Display name for the action
            &quot;description&quot;: &quot;Turns the light on.&quot;, // Optional description
            &quot;id&quot;: &quot;turn_light_on&quot;, // A unique id
            &quot;updateState&quot;: &quot;on&quot;, // Updates state on function call
            &quot;schedule&quot;: &quot;at 9:00am&quot;, // Optional scheduling using later.js
            &quot;event&quot;: &quot;Light turned on&quot;, // Optional event to emit when called.
            &quot;function&quot;: function () {
                // The implementation of the action.
                // Here we simply log &quot;Light on.&quot; See links to hardware
                // examples below to begin using microcontrollers
                console.log(&quot;Light on.&quot;); 
            }
        },
        {
            &quot;name&quot;: &quot;off&quot;,
            &quot;id&quot;: &quot;turn_light_off&quot;,
            &quot;updateState&quot;: &quot;off&quot;,
            &quot;schedule&quot;: &quot;at 8:30pm&quot;,
            &quot;event&quot;: &quot;Light turned off&quot;,
            &quot;function&quot;: function () {
                console.log(&quot;Light off.&quot;);
            }
        }
    ]
}, function start () {
    // Optional Callback. Calls turn_light_off function on start.
    grow.callAction(&quot;turn_light_off&quot;);
});
</code></pre>
<p>Run the new <code>example.js</code> file with:</p><pre><code class="lang-bash">node example.js
</code></pre>
<p>This does a couple of things:</p><ol>
<li>Connects to the host over the ddp protocol.</li>
<li>Registers the device with host server. The information in config object is used to create a UI and API.</li>
<li>Sets up streams and listens for commands.</li>
</ol>
<p>On the grow app the device looks like so:</p><h2>Using the Grow App.</h2>
<ol>
<li><p>Create an acount by visiting <a href="https://grow.commongarden.org">https://grow.commongarden.org</a> or <a href="http://localhost:3000">http://localhost:3000</a> if running <a href="">Grow-IoT</a> locally.</p></li>
<li></li>
</ol>
<p>From this we&#39;re able to generate a bit of UI using meteor-iot: [TODO: insert image]</p><h1>Hardware examples</h1>
<p>You will need a microcontroller (such as arduino or raspberry pi). Grow.js works with most devices that can run node, and plays very well with the <a href="http://johnny-five.io/">Johnny-Five robotics library</a>, which has plugins for <a href="http://johnny-five.io/#platform-support">a large number of devices</a>. Note, with boards like the Tessel 2, Johnny-five is not required.</p><h2>The configuration object</h2>
<p>The following properties are supported:</p><p><strong>name</strong>: <em>(required)</em> The name of the thing.</p><p><strong>id</strong>: <em>(required)</em> Must not be shared with any components or actions in the thing.json file. Maybe this could be auto generated?</p><p><strong>owner</strong>: <em>(currently required)</em> Currently the email address of the account the device will be added to when it connects. Public devices will not have an owner... but that&#39;s a work in progress.</p><p><strong>state</strong>: the current state of the thing. For example, &#39;on&#39; or &#39;off&#39;.</p><p><strong>type</strong>: The type of thing, eventually we are going to fine tune the UI for common components like temperature sensors, etc.</p><p><strong>description</strong>: A description for the thing.</p><p><strong>actions</strong>: A list of action objects.</p><p><strong>events</strong>: A list of event objects.</p><p><strong>template</strong>: EXPERIMENTAL -- A web component to use as a template for the ui.</p><p>The cool thing is that things can contain other things! The <code>components</code> property takes list of thing objects.</p><p><strong>components</strong>: A list of thing objects.</p><p>Currently, we don&#39;t allow components to have a <code>components</code> property.</p><h3>Actions</h3>
<p>The <code>actions</code> property of a thing or component has it&#39;s own structure.</p><p><strong>name</strong>: <em>(required)</em> the name of the action. For example, &quot;water plant&quot;.</p><p><strong>id</strong>: <em>(required)</em> the name of the function to call. This much match what is in the implementation.</p><p><strong>options</strong>: an additional arguments or parameters for the function.</p><p><strong>schedule</strong>: a valid later.js text experession that sets up a recurring action, see the <a href="http://bunkat.github.io/later/">later.js documentation</a> for more info.</p><p><strong>event</strong>: setting this emits an event when the action is called.</p><p><strong>function</strong>: the actual implmentation of the action, this code is run when the action is called, and is not exchanged in any communications.</p><h3>Events</h3>
<p>Coming soon: <em>a way to subscribe to device events.</em></p><h3>state.json</h3>
<p>The state.json file is also used for state. In case the device looses internet connnection or power and needs to reset, the grow file contains the instructions such as schedules, where the device is supposed to connect to.</p><p>Check out the driver examples for more code.</p><h3>Host / Port</h3>
<p>The host is where the device will be looking for a CommonGarden-IoT instance. By default the host is set to <code>localhost</code> and the port is set to Meteor&#39;s standard of <code>3000</code>. This will work nicely for usb devices like Arduino.</p><h4>Connecting over wifi</h4>
<p>Set the <code>host</code> to your computer&#39;s IP address where the Grow-IoT instance is running. Simply specify it in your grow.json file.</p><pre><code class="lang-json">    &quot;host&quot;: &quot;YOUR_IP_HERE&quot;,
    &quot;thing&quot;: {...}
</code></pre>
<p>Likewise if you are hosting in the cloud, it should be set to the instance IP address, you can also override the default port by specifiying the <code>port</code> option.</p><h4>Connecting over SSL</h4>
<p>SSL is supported though will require a bit more setup. If you are hosting your instance off a computer with a dedicated IP address include the following info in your configuration object.</p><pre><code class="lang-json">    &quot;host&quot;: &quot;YOUR_IP_HERE&quot;,
    &quot;port&quot;: 443,
    &quot;ssl&quot;: true,
</code></pre>
<p>If you are hosting on a cloud instance, you might need specify the servername. The example below shows you how to connect securely to the instance at <a href="https://grow.commongarden.org">grow.commongarden.org</a>:</p><pre><code class="lang-json">    &quot;host&quot;: &quot;grow.commongarden.org&quot;,
    &quot;tlsOpts&quot;: {
        &quot;tls&quot;: {
            &quot;servername&quot;: &quot;galaxy.meteor.com&quot;
        }
    },
    &quot;port&quot;: 443,
    &quot;ssl&quot;: true,
    &quot;thing&quot;: { ... }
</code></pre>
<h1>Developing</h1>
<pre><code class="lang-bash">git clone https://github.com/CommonGarden/grow.js
cd grow.js
npm install
</code></pre>
<p>We use <a href="http://gulpjs.com/">gulp</a> as our task runner. We use it to run tests, build docs, minify the code, lint things, etc.</p><p><code>gulp build</code> concatonates the files in the <code>src</code> folder into one grow.js file.</p><p><code>gulp test</code> runs tests in the test folder.</p><p><code>gulp docs</code> builds the documentation in the docs folder.</p><h2>Contributing</h2>
<p>Please read:</p><ul>
<li><a href="https://github.com/CommonGarden/Organization/blob/master/code-of-conduct.md">Code of Conduct</a></li>
<li><a href="https://github.com/CommonGarden/Organization/blob/master/contributing.md">Contributing info</a></li>
</ul>
<h3>Reach out</h3>
<p>Get involved with our community in any way you are interested:</p><ul>
<li><a href="http://slack.commongarden.org">Join us on Slack</a> — Collaboration and real time discussions.</li>
<li><a href="http://forum.commongarden.org/">Forum</a> — General discussion and support by the Common Garden community.</li>
</ul>
<h3>Acknowledgements</h3>
<p>Special thanks to @Mitar for contributing the starting point for this library. This work was also inspired by work the <a href="https://github.com/w3c/web-of-things-framework">W3C interest group on the internet of things</a>.</p><h2>License</h2>
<p>Grow.js is released under the 2-Clause BSD License, sometimes referred to as the &quot;Simplified BSD License&quot; or the &quot;FreeBSD License&quot;.</p></section>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p>Documentation generated with <a href="https://github.com/FGRibreau/doxx">Doxx </a> created by <a href="https://twitter.com/FGRibreau" data-show-count="false" class="twitter-follow-button">Francois-Guillaume Ribreau </a></p>
        <p>Doxx is sponsored by <a href="http://bringr.net/?btt" title="Outil d'analyse des réseaux sociaux" class="bringr">Bringr </a> and <a href="https://redsmin.com/?btt" title="Full Redis GUI" class="redsmin">Redsmin</a></p>
        <p>Theme borrowed from Twitter Bootstrap</p>
      </div>
    </footer>
    <script src="http://platform.twitter.com/widgets.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    <script src="http://leaverou.github.com/prefixfree/prefixfree.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-transition.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-collapse.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-affix.js"></script>
    <script>
      /**
       * Prism: Lightweight, robust, elegant syntax highlighting
       * MIT license http://www.opensource.org/licenses/mit-license.php/
       * @author Lea Verou http://lea.verou.me
       */(function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.util.clone(e[i]));return r;case"Array":return e.slice()}return e}},languages:{extend:function(e,n){var r=t.util.clone(t.languages[e]);for(var i in n)r[i]=n[i];return r},insertBefore:function(e,n,r,i){i=i||t.languages;var s=i[e],o={};for(var u in s)if(s.hasOwnProperty(u)){if(u==n)for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);o[u]=s[u]}return i[e]=o},DFS:function(e,n){for(var r in e){n.call(e,r,e[r]);t.util.type(e)==="Object"&&t.languages.DFS(e[r],n)}}},highlightAll:function(e,n){var r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');for(var i=0,s;s=r[i++];)t.highlightElement(s,e===!0,n)},highlightElement:function(r,i,s){var o,u,a=r;while(a&&!e.test(a.className))a=a.parentNode;if(a){o=(a.className.match(e)||[,""])[1];u=t.languages[o]}if(!u)return;r.className=r.className.replace(e,"").replace(/\s+/g," ")+" language-"+o;a=r.parentNode;/pre/i.test(a.nodeName)&&(a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var f=r.textContent;if(!f)return;f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g," ");var l={element:r,language:o,grammar:u,code:f};t.hooks.run("before-highlight",l);if(i&&self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){l.highlightedCode=n.stringify(JSON.parse(e.data));l.element.innerHTML=l.highlightedCode;s&&s.call(l.element);t.hooks.run("after-highlight",l)};c.postMessage(JSON.stringify({language:l.language,code:l.code}))}else{l.highlightedCode=t.highlight(l.code,l.grammar);l.element.innerHTML=l.highlightedCode;s&&s.call(r);t.hooks.run("after-highlight",l)}},highlight:function(e,r){return n.stringify(t.tokenize(e,r))},tokenize:function(e,n){var r=t.Token,i=[e],s=n.rest;if(s){for(var o in s)n[o]=s[o];delete n.rest}e:for(var o in n){if(!n.hasOwnProperty(o)||!n[o])continue;var u=n[o],a=u.inside,f=!!u.lookbehind||0;u=u.pattern||u;for(var l=0;l<i.length;l++){var c=i[l];if(i.length>e.length)break e;if(c instanceof r)continue;u.lastIndex=0;var h=u.exec(c);if(h){f&&(f=h[1].length);var p=h.index-1+f,h=h[0].slice(f),d=h.length,v=p+d,m=c.slice(0,p+1),g=c.slice(v+1),y=[l,1];m&&y.push(m);var b=new r(o,a?t.tokenize(h,a):h);y.push(b);g&&y.push(g);Array.prototype.splice.apply(i,y)}}}return i},hooks:{all:{},add:function(e,n){var r=t.hooks.all;r[e]=r[e]||[];r[e].push(n)},run:function(e,n){var r=t.hooks.all[e];if(!r||!r.length)return;for(var i=0,s;s=r[i++];)s(n)}}},n=t.Token=function(e,t){this.type=e;this.content=t};n.stringify=function(e){if(typeof e=="string")return e;if(Object.prototype.toString.call(e)=="[object Array]"){for(var r=0;r<e.length;r++)e[r]=n.stringify(e[r]);return e.join("")}var i={type:e.type,content:n.stringify(e.content),tag:"span",classes:["token",e.type],attributes:{}};i.type=="comment"&&(i.attributes.spellcheck="true");t.hooks.run("wrap",i);var s="";for(var o in i.attributes)s+=o+'="'+(i.attributes[o]||"")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'" '+s+">"+i.content+"</"+i.tag+">"};if(!self.document){self.addEventListener("message",function(e){var n=JSON.parse(e.data),r=n.language,i=n.code;self.postMessage(JSON.stringify(t.tokenize(i,t.languages[r])));self.close()},!1);return}var r=document.getElementsByTagName("script");r=r[r.length-1];if(r){t.filename=r.src;document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll)}})();;
      Prism.languages.markup={comment:/&lt;!--[\w\W]*?--(&gt;|&gt;)/g,prolog:/&lt;\?.+?\?&gt;/,doctype:/&lt;!DOCTYPE.+?&gt;/,cdata:/&lt;!\[CDATA\[[\w\W]+?]]&gt;/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?&gt;/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|&gt;|"/g}},punctuation:/\/?&gt;/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi};Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});;
      Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:/@[\w-]+?(\s+[^;{]+)?(?=\s*{|\s*;)/gi,url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\}]*(?=\s*\{)/g,property:/(\b|\B)[a-z-]+(?=\s*:)/ig,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g};Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}});;
      Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,number:/\b-?(0x)?\d*\.?[\da-f]+\b/g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g};;
      Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|catch|finally|null|break|continue)\b/g,number:/\b(-?(0x)?\d*\.?[\da-f]+|NaN|-?Infinity)\b/g});Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}});Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}});;
      
    </script>
    <!-- App js-->
    <script>
      $(function(){
        var $window = $(window);
        $('.scrollspy .nav').affix({
          offset: {
            top: function () { return $window.width() <= 980 ? 480 : 400 }
          , bottom: 50
          }
        });
      })
    </script>
  </body>
</html>